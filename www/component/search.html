<div>
	<div id="searchForm">
		<h3 align="left" style="margin-bottom: 15px">search by entering tags bellow</h3>
		<div id="addBtn" align="center">
			<img src="img/add-icon.png" class="image" alt="" />or add new entry
		</div>
		<ul id="searchField"></ul>
	</div>
	
	<div id="resultsDiv"></div>
	
	<script>
	//<![CDATA[
	    
		// add new entry functionality
		$("#addBtn", this).click(function(){
			var addDialog = Component.fromPath("component/add");
			SexyLightbox.initialize();
			SexyLightbox.showDOM(null,addDialog,500,200,true,"#000000");
			addDialog.dialog = SexyLightbox;
		});
		
		
		// autocomplete functionality
		$("#searchField", this).tagit({
			source: app.endpoint+"suggest/search.jsonp",
			jsonp: true,
			param: 'q'
		});
		
		$("#searchField", this).bind("onchanged",function(){
			var term = $("#searchField")[0].getValue();
			$.getJSON(app.endpoint+"search.jsonp?q="+term+"&callback=?", function(response) {
				$("#resultsDiv").fadeOut("fast",function(){
					$("#resultsDiv").empty();
					console.log(response);
		        	if(response.length){
						var resultsDiv = $('#resultsDiv');
						for(var i=0;i<response.length;i++){
							// Creating a new result object and firing its toString method:
							resultsDiv.append(new result(response[i]) + '');
						}
					}
		        	$("#resultsDiv").fadeIn("fast");
				});
		    });
		});
		
		
		function result(r){
			
			// This is class definition. Object of this class are created for
			// each result. The markup is generated by the .toString() method.
			
			var arr = [];
			
			arr = [
				'<div class="webResult">',
				'<h2><a href="',r.url,'" target="_blank">',r.name,'</a></h2>',
				'<a href="',r.url,'" target="_blank">',r.ul,'</a>',
				'</div>'
			];
				
			
			// The toString method.
			this.toString = function(){
				return arr.join('');
			}
		}
	//]]>
	</script>
</div>